# Sequential Research Agent Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Rewrite the research agent to use sequential execution with full MCP access, following writing-skills best practices (concise, templates extracted, quick reference).

**Architecture:** Lead Researcher skill runs in main session, calling MCP tools directly in sequence: GitHub ‚Üí Reddit ‚Üí Twitter ‚Üí LinkedIn ‚Üí Web ‚Üí Synthesis. No Task tool subagents (they can't access MCP).

**Tech Stack:** Claude Code skills, Brave Search MCP, GitHub MCP, Context7 MCP, WebSearch (built-in), agent-browser (via Bash)

---

## Task 1: Clean Up Old Subagent Prompts

**Files:**
- Delete: `.claude/prompts/` (entire directory)

**Step 1: Remove prompts directory**

```bash
rm -rf .claude/prompts
```

**Step 2: Verify removal**

```bash
ls .claude/
```

Expected: No `prompts` directory

**Step 3: Commit**

```bash
git add -A
git commit -m "chore: remove subagent prompts (moving to sequential architecture)"
```

---

## Task 2: Update CLAUDE.md

**Files:**
- Modify: `CLAUDE.md`

**Step 1: Rewrite CLAUDE.md with new architecture**

Replace entire contents with:

```markdown
# Research Agent

Sequential multi-source research with full MCP access.

## Quick Start

```
/research <URL | topic | image-path>
```

Skip for simple factual questions ‚Äî answer directly.

## Tools

| Tool | Use For |
|------|---------|
| GitHub MCP | Repository health, issues, code |
| Brave Search MCP | Web search with freshness, news |
| Context7 MCP | Library/framework docs |
| WebSearch | Quick discovery, domain filtering |
| agent-browser | Deep content extraction |

## Research Flow

1. **GitHub** ‚Üí Repository health, technical signals
2. **Reddit** ‚Üí Community sentiment (Brave search)
3. **Twitter** ‚Üí Real-time buzz (Brave search)
4. **LinkedIn** ‚Üí Professional adoption (WebSearch)
5. **Web** ‚Üí News, docs, comparisons (Brave + Context7)
6. **Synthesis** ‚Üí Unified report

## Paths

| Path | Purpose |
|------|---------|
| `.claude/skills/research/` | Skill + templates |
| `.claude/research-cache/` | Session temp data |
| `research/catalogue.md` | Index |
| `research/catalogue/` | Reports |
```

**Step 2: Commit**

```bash
git add CLAUDE.md
git commit -m "docs: update CLAUDE.md for sequential architecture"
```

---

## Task 3: Create Templates Reference

**Files:**
- Create: `.claude/skills/research/templates.md`

**Step 1: Create templates file**

```markdown
# Research Output Templates

## Findings Format (per source)

### GitHub Findings
```markdown
## GitHub Findings

### Repository
- Name: [owner/repo]
- Stars: N | Forks: N
- Last commit: YYYY-MM-DD
- Status: [Active/Stale/Abandoned]

### Technical Signals
- Language: [X]
- CI/CD: [Yes/No]
- Tests: [Yes/No/Unknown]

### Red Flags
- [Issues or "None"]

### Sources
- [URLs]
```

### Reddit Findings
```markdown
## Reddit Findings

### Sentiment
- Overall: [Positive/Mixed/Negative]
- Confidence: [High/Medium/Low]

### Common Praise
- [Theme]: "[quote]"

### Common Complaints
- [Theme]: "[quote]"

### Notable Threads
- [Title](URL) - [takeaway]

### Sources
- [URLs]
```

### Twitter Findings
```markdown
## Twitter Findings

### Buzz Level
- Volume: [High/Medium/Low/Minimal]
- Trend: [Rising/Stable/Declining]

### Influencer Takes
- [@handle]: "[quote]" - [Sentiment]

### General Sentiment
- [Summary]

### Sources
- [URLs]
```

### LinkedIn Findings
```markdown
## LinkedIn Findings

### Professional Adoption
- Company mentions: [list]
- Job listings: [None/Few/Moderate/High]

### Industry Commentary
- [Posts or "Limited - login walls"]

### Sources
- [URLs]
```

### Web Findings
```markdown
## Web Findings

### Documentation
- Source: [Context7/Official]
- Capabilities: [list]

### News
- [Date]: [Headline](URL) - [summary]

### Pricing
- Model: [Free/Freemium/Paid/Enterprise]

### Competitors
| Name | Difference |
|------|------------|

### Sources
- [URLs]
```

---

## Key Insights Format (displayed immediately)

```markdown
## Key Insights: <topic>

**What it is:** [one sentence]
**What's novel:** [differentiator]
**How it compares:** [position]
**Bottom line:** [recommendation]

üìÑ Full report: research/catalogue/YYYY-MM-DD-<slug>.md
```

---

## Full Report Format

```markdown
---
topic: <topic>
slug: <slug>
date: YYYY-MM-DD
sources: [github, reddit, twitter, linkedin, web]
---

# <Topic> Research Report

## Overview
[2-3 paragraphs synthesizing all findings]

## Technical Analysis
[From GitHub + Web]

## User Sentiment
**Overall:** [Positive/Mixed/Negative]
- Reddit: [summary]
- Twitter: [summary]
- LinkedIn: [summary]

## Competitive Landscape
[From Web]

## Pros and Cons
| Pros | Cons |
|------|------|

## Sources
[All URLs]

---
*Generated by Research Agent on YYYY-MM-DD*
```

---

## Catalogue Index Row

```markdown
| YYYY-MM-DD | Topic | [Sentiment] | [Report](catalogue/YYYY-MM-DD-slug.md) |
```
```

**Step 2: Commit**

```bash
git add .claude/skills/research/templates.md
git commit -m "docs: add research output templates"
```

---

## Task 4: Rewrite Main Research Skill (Concise)

**Files:**
- Modify: `.claude/skills/research/SKILL.md`

**Step 1: Rewrite with concise format**

Replace entire contents with:

```markdown
---
name: research
description: Use when given a topic, URL, or image to investigate across GitHub, Reddit, Twitter, LinkedIn, and web
---

# Research Agent

Sequential multi-source research with full MCP access.

## When to Use

**Use for:** Products, tools, libraries, companies, technologies needing comprehensive analysis

**Skip for:** Simple facts, definitions, quick lookups ‚Äî answer directly

## Quick Reference

| Step | Tools | Output |
|------|-------|--------|
| Setup | Parse input, generate session ID | `.claude/research-cache/<session>/` |
| GitHub | GitHub MCP | `github-findings.md` |
| Reddit | WebSearch ‚Üí Brave (`site:reddit.com`, `freshness: py`) | `reddit-findings.md` |
| Twitter | WebSearch ‚Üí Brave (`site:x.com`, `freshness: pm`) | `twitter-findings.md` |
| LinkedIn | WebSearch (`allowed_domains: ["linkedin.com"]`) | `linkedin-findings.md` |
| Web | WebSearch ‚Üí Brave news ‚Üí Context7 | `web-findings.md` |
| Synthesis | Read all findings ‚Üí Generate report | `research/catalogue/YYYY-MM-DD-<slug>.md` |

## Workflow

### 1. Setup

1. Parse input: URL ‚Üí extract domain/path | Image ‚Üí Read + extract subject | Text ‚Üí use directly
2. Generate slug: `lowercase ‚Üí replace [^a-z0-9] with "-" ‚Üí collapse ‚Üí trim 50 chars`
3. Generate session ID: `YYYYMMDD-HHMMSS-<slug>`
4. Create: `.claude/research-cache/<session_id>/`
5. Display: `üîç Researching **<topic>**...`

### 2. GitHub Research

**Tools:** GitHub MCP (`search_repositories`, `get_file_contents`, `list_issues`)

1. Search for topic, find primary repo
2. Examine README, issues, PRs, releases
3. Assess: active/stale/abandoned
4. Write to `github-findings.md` (see templates.md)

### 3. Reddit Research

**Tools:** WebSearch ‚Üí Brave MCP ‚Üí agent-browser (if needed)

1. WebSearch `{topic}` to find themes
2. Brave `brave_web_search`: `site:reddit.com {topic}`, `freshness: py`, `count: 20`
3. If high-engagement thread: agent-browser for comments
4. Write to `reddit-findings.md`

### 4. Twitter Research

**Tools:** WebSearch ‚Üí Brave MCP

1. WebSearch `{topic}` to find influencers, buzz
2. Brave `brave_web_search`: `site:x.com OR site:twitter.com {topic}`, `freshness: pm`, `count: 20`
3. Write to `twitter-findings.md`

### 5. LinkedIn Research

**Tools:** WebSearch only

1. WebSearch with `allowed_domains: ["linkedin.com"]`
2. Note: Login walls limit depth ‚Äî capture what's visible
3. Write to `linkedin-findings.md`

### 6. Web Research

**Tools:** WebSearch ‚Üí Brave news ‚Üí Context7 ‚Üí agent-browser (if needed)

1. WebSearch `{topic} review OR comparison`
2. Brave `brave_news_search`, `freshness: pm`, `count: 20`
3. Context7: `resolve-library-id` ‚Üí `get-library-docs` (if applicable)
4. agent-browser for pricing pages, comparison tables (if needed)
5. Write to `web-findings.md`

### 7. Synthesis

1. Read all 5 findings files
2. Identify themes across sources
3. Display Key Insights immediately (see templates.md)
4. Write full report to `research/catalogue/YYYY-MM-DD-<slug>.md`
5. Append row to `research/catalogue.md`

## Common Mistakes

| Mistake | Fix |
|---------|-----|
| Skipping GitHub for non-code topics | Always check ‚Äî many products have repos |
| Deep-diving one source | Balance across all 5 |
| Missing Context7 for libraries | Always try `resolve-library-id` |
| Forgetting freshness params | Reddit: `py` (year), Twitter: `pm` (month) |

## Output Formats

See `templates.md` in this directory for all output formats.
```

**Step 2: Verify conciseness**

```bash
wc -w .claude/skills/research/SKILL.md
```

Expected: Under 500 words

**Step 3: Commit**

```bash
git add .claude/skills/research/SKILL.md
git commit -m "feat: rewrite research skill - concise, sequential, MCP-enabled"
```

---

## Task 5: Verify MCP Configuration

**Files:**
- Check: `~/.claude.json` (user-scope MCP)

**Step 1: Verify all MCP servers present**

```bash
grep -A5 '"brave-search"' ~/.claude.json
grep -A5 '"github"' ~/.claude.json
grep -A5 '"context7"' ~/.claude.json
```

Expected: All three servers with correct config

**Step 2: Verify Brave API key**

```bash
grep "BRAVE_API_KEY" ~/.claude.json | head -1
```

Expected: Key present (not empty)

**Step 3: No commit needed** (user config not in repo)

---

## Task 6: Smoke Test

**Step 1: Start fresh Claude session**

```bash
cd /Users/razpetel/projects/researcher
claude
```

**Step 2: Verify skill loads**

Type `/` ‚Äî verify `research` appears in autocomplete

**Step 3: Test minimal research**

```
/research cursor ide
```

**Step 4: Verify outputs**

- Cache files created in `.claude/research-cache/`
- Report created in `research/catalogue/`
- Index updated in `research/catalogue.md`

---

## Summary

| Task | Description | Files |
|------|-------------|-------|
| 1 | Remove old prompts | `.claude/prompts/` (delete) |
| 2 | Update CLAUDE.md | `CLAUDE.md` |
| 3 | Create templates | `.claude/skills/research/templates.md` |
| 4 | Rewrite skill (concise) | `.claude/skills/research/SKILL.md` |
| 5 | Verify MCP config | `~/.claude.json` (check) |
| 6 | Smoke test | Manual |

## Hooks Assessment

**No hooks needed.** The skill is self-contained:
- Creates cache directory on demand
- Handles errors inline
- Validates inputs in workflow

Hooks would add complexity without benefit.
